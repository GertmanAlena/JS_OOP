<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // Объект робот-пылесос.
        const Roomba = { // Есть негласное правило называть объекты в
        // алгоритмах с большой буквы.
        // Обычно сначала объявляют свойства объекта.
        model: "Romba-1",
        power: 200,
        batterySize: 2100,
        boxSize: 0.5,
        workTime: 45,
        counterOfStarts: 0,
        isFull: false,
        isObstacle: false,
        isUVLampOn: false,

        // После свойств объявляют его методы.
            startCleaning: function () {
                this.counterOfStarts++;
                console.log('I am cleaning... I have been started: ',
                this.counterOfStarts, 'times.');
            },
            goCharge: function () {
            console.log('I am going to charge...');
            },
            switchUVLamp: function () {
                this.isUVLampOn = !this.isUVLampOn;
                console.log(`UV lamp is ${this.isUVLampOn ? 'working' :
                'not working'}.`);
            }
        };

        // Обращение к свойствам объекта.
        console.log(Roomba.model); // "Romba-1"
        console.log(Roomba.isFull); // false
        // Вызов методов объекта.
        Roomba.startCleaning(); // 'I am cleaning... I have been started: 1 times.'
        // Установим свойства объекта isUVLampOn в true, чтобы
        // продемонстрировать результат работы метода switchUVLamp.
        Roomba.isUVLampOn = true;
        // Результат вызова следующего метода зависит от значения,
        // хранящегося в свойстве объекта, а также от того как этот метод
        // был вызван (об этом поговорим чуть ниже).
        Roomba.switchUVLamp(); // 'UV lamp is not working.'
        Roomba.goCharge(); // 'I am going to charge...'

        // Объект Roomba - робот-пылесос. Код самого объекта смотри в
        // листинге 1.
        // Объект робот-пылесос модель Tango.

        const Tango = { // Есть негласное правило называть объекты в
            // алгоритмах с большой буквы.
            // Обычно сначала объявляют свойства объекта.
            model: "Tango-1",
            power: 300,
            batterySize: 3200,
            boxSize: 0.7,
            workTime: 60,
            counterOfStarts: 0,
            isFull: false,
            isObstacle: false,
            isUVLampOn: false,
            // После свойств объявляют его методы. А так как методы у
            // новой модели такие же как и у старой, давайте позаимствуем их у
            // объекта Roomba.
            startCleaning: Roomba.startCleaning,
            goCharge: Roomba.goCharge,
            switchUVLamp: Roomba.switchUVLamp,
        };

        // Объект Roomba - робот-пылесос. Код самого объекта смотри в
        // листинге 1.
        // Обращение к свойствам и методом объекта Roomba. Код обращения
        // смотри в листинге 2.
        // Объект Tango - робот-пылесос. Код самого объекта смотри в
        // листинге 5.
        // Обращение к свойствам объекта Tango.
        console.log(Tango.model); // "Tango-1"
        console.log(Tango.isFull); // false
        // Вызов методов объекта.
        Tango.startCleaning(); // 'I am cleaning... I have been started:
        // 1 times.'
        // Установим свойства объекта isUVLampOn в true, чтобы
        // продемонстрировать результат работы метода switchUVLamp.
        Tango.isUVLampOn = true;
        // Результат вызова следующего метода зависит от значения,
        // хранящегося в свойстве объекта, а также от того как этот метод
        // был вызван (об этом поговорим чуть ниже).
        Tango.switchUVLamp(); // 'UV lamp is not working.'
        Tango.goCharge(); // 'I am going to charge...'

        // Объект робот-пылесос модель Samba.
        const Samba = {
            model: "Samba-1",
            power: 250,
            batterySize: 2500,
            boxSize: 0.5,
            workTime: 50,
            counterOfStarts: 0,
            isFull: false,
            isObstacle: false,
            isUVLampOn: false,
            // На этот раз мы не будем создавать методы в объекте, мы
            // постараемся их заимствовать непосредственно перед использованием.
        };

        // Объект Samba - робот-пылесос. Код самого объекта смотри в
        // листинге 7.
        // Обращение к свойствам объекта Samba.
        console.log(Samba.model); // "Samba-1"
        console.log(Samba.isFull); // false
        // Одолжим методы из объекта Roomba.
        Samba.startCleaning = Roomba.startCleaning; //startCleaning у Samba небыло, тут он создаётся
        Samba.switchUVLamp = Roomba.switchUVLamp;
        Samba.goCharge = Roomba.goCharge;
        // Вызов методов объекта.
        Samba.startCleaning(); // 'I am cleaning... I have been started:
        // 1 times.'
        // Установим свойства объекта isUVLampOn в true, чтобы
        // продемонстрировать результат работы метода switchUVLamp.
        Samba.isUVLampOn = true;
        // Результат вызова следующего метода зависит от значения,
        // хранящегося в свойстве объекта, а также от того как этот метод
        // был вызван (об этом поговорим чуть ниже).
        Samba.switchUVLamp(); // 'UV lamp is not working.'
        Samba.goCharge(); // 'I am going to charge...'

        //****************************************Привязка контекста

        // Объект Roomba - робот-пылесос. Код самого объекта смотри в
        // листинге 1.
        // Обращение к свойствам объекта.
        console.log(Roomba.model); // "Romba-1"
        console.log(Roomba.isFull); // false

        // Вызов методов объекта. НЕ ПРАВИЛЬНЫЙ ВЫЗОВ!!!!!!!
        setTimeout(Roomba.startCleaning, 1000);

        // Вызов методов объекта. ПРАВИЛЬНЫЙ ВЫЗОВ через анонимную функцию
        setTimeout(function () {
            Roomba.startCleaning();
        }, 1000);


        // Установим свойства объекта isUVLampOn в true, чтобы
        // продемонстрировать результат работы метода switchUVLamp.
        Roomba.isUVLampOn = true;
        // Результат вызова следующего метода зависит от значения,
        // хранящегося в свойстве объекта, а также от того как этот метод
        // был вызван (об этом поговорим чуть ниже).
        setTimeout(Roomba.switchUVLamp, 2000); // НЕ ПРАВИЛЬНЫЙ ВЫЗОВ!!!!!!!
        setTimeout(Roomba.goCharge, 3000);     // НЕ ПРАВИЛЬНЫЙ ВЫЗОВ!!!!!!!

        //ПРАВИЛЬНЫЙ ВЫЗОВ через анонимную функцию
        setTimeout(function () {
            Roomba.switchUVLamp();
        }, 2000);
        setTimeout(function () {
            Roomba.goCharge();
        }, 3000);

        // I am cleaning... I have started: NaN times.
        // UV lamp is working.
        // I am going to charge...
        console.log(Roomba.model); // "Romba-1"
        console.log(Roomba.isFull); // false
        Roomba.startCleaning.call(Roomba); 
        const notARobot = {
            counterOfStarts: 10,
        };
        Roomba.startCleaning.call(notARobot);

        console.log(Roomba.model); // "Romba-1"
        console.log(Roomba.isFull); // false
        Roomba.startCleaning.call(Roomba);
        const notARobot2 = {
            counterOfStarts: 10,
        };
        Roomba.startCleaning.call(notARobot2); //11

    </script>
</body>
</html>